<!DOCTYPE html>
<html ng-app="OptionsApp" ng-csp ng-controller="OptionsController">

    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title get-message="OptionsPageTitle"></title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css">
    </head>

    <body class="pad-y-sm pad-x-0" ng-class="{'firefox': isFirefox}">

        <!-- BEGIN SETTINGS -->

        <form name="optionsForm" class="container-fluid">

            <div class="alert alert-primary text-small">
                <div class="row">
                    <div class="col-auto pad-r-0">
                        <span class="fa-stack fa-lg">
                            <i class="fa fa-cloud fa-stack-1x"></i>
                            <i class="fa fa-ban fa-stack-2x text-danger"></i>
                        </span>
                    </div>
                    <div class="col">
                        <i18n message="OptionsPerDeviceWarning"></i18n>
                    </div>
                </div>
            </div>

            <fieldset>
                <legend class="text-primary">
                    <i class="fa fa-sliders mar-r-xs"></i>
                    <i18n message="OptionsBehaviorHeading"></i18n>
                </legend>

                <!-- Show Controls -->
                <div class="input-field" ng-class="{'input-invalid': optionsForm.behaviorControls.$invalid}">
                    <label for="behaviorControls" get-message="BehaviorControlsLabel"></label>
                    <select name="behaviorControls" id="behaviorControls" ng-model="options.behavior.controls" ng-change="validateBehaviorControlsValue()" required>
                        <option value="none" get-message="BehaviorControlsNoneOptionLabel"></option>
                        <option value="standard" get-message="BehaviorControlsStandardOptionLabel"></option>
                        <option value="extended" get-message="BehaviorControlsExtendedOptionLabel"></option>
                    </select>
                    <p class="input-hint text-primary" ng-show="optionsForm.behaviorControls.$dirty && optionsForm.behaviorControls.$valid">
                        <i class="fa fa-check-square-o"></i>
                        <i18n message="OptionsSaveSettingsReminder"></i18n>
                    </p>
                    <p class="input-hint" get-message="BehaviorControlsDescription"></p>
                </div>
                <!-- Show Controls -->

                <!-- Toggle Autoplay -->
                <div class="input-field">
                    <span class="switch">
                        <input type="checkbox" name="behaviorAutoplay" id="behaviorAutoplay" ng-model="options.behavior.autoplay">
                        <label for="behaviorAutoplay" get-message="OptionsBehaviorAutoplayLabel"></label>
                        <p class="input-hint text-primary" ng-show="optionsForm.behaviorAutoplay.$dirty && optionsForm.behaviorAutoplay.$valid">
                            <i class="fa fa-check-square-o"></i>
                            <i18n message="OptionsSaveSettingsReminder"></i18n>
                        </p>
                        <p class="input-hint" get-message="OptionsBehaviorAutoplayDescription"></p>
                    </span>
                </div>
                <!-- End Toggle Autoplay -->

                <!-- Toggle Loop -->
                <div class="input-field">
                    <span class="switch">
                        <input type="checkbox" name="behaviorLoop" id="behaviorLoop" ng-model="options.behavior.loop">
                        <label for="behaviorLoop" get-message="OptionsBehaviorLoopLabel"></label>
                        <p class="input-hint text-primary" ng-show="optionsForm.behaviorLoop.$dirty && optionsForm.behaviorLoop.$valid">
                            <i class="fa fa-check-square-o"></i>
                            <i18n message="OptionsSaveSettingsReminder"></i18n>
                        </p>
                        <p class="input-hint" get-message="OptionsBehaviorLoopDescription"></p>
                    </span>
                </div>
                <!-- End Toggle Loop -->

            </fieldset>

            <fieldset>
                <legend class="text-primary">
                    <i class="fa fa-window-maximize mar-r-xs"></i>
                    <i18n message="OptionsSizeHeading"></i18n>
                </legend>

                <ng-form name="sizeModeForm">

                    <div class="input-field">
                        <label>
                            <input type="radio" name="sizeMode" value="current" ng-model="options.size.mode" required>
                            <i18n message="OptionsSizeModeCurrentLabel"></i18n>
                            <p class="input-hint" get-message="OptionsSizeModeCurrentDescription"></p>
                        </label>
                    </div>

                    <div class="input-field mar-b-0">
                        <label>
                            <input type="radio" name="sizeMode" value="custom" ng-model="options.size.mode" required>
                            <i18n message="OptionsSizeModeCustomLabel"></i18n><br />
                            <p class="input-hint" get-message="OptionsSizeModeCustomDescription"></p>
                        </label>
                    </div>

                </ng-form>

                <div class="container-fluid mar-t-sm" ng-show="options.size.mode === 'custom'">

                    <div ng-form="sizeDimensionsForm" class="input-field mar-b-0">
                        <div class="row">

                            <!-- Size Dimensions -->
                            <div class="col">
                                <div class="input-field" ng-class="{'input-invalid': optionsForm.sizeDimensionsForm.sizeModeUnits.$invalid}">
                                    <label for="sizeModeUnits" get-message="DimensionUnitsLabel"></label>
                                    <select name="sizeModeUnits" id="sizeModeUnits" ng-model="options.size.units" ng-change="validateSizeUnitsValue()" required>
                                        <option value="pixels" get-message="DimensionUnitsPixelsOptionLabel"></option>
                                        <option value="percentage" get-message="DimensionUnitsPercentageOptionLabel"></option>
                                    </select>
                                </div>
                            </div>
                            <!-- End Size Dimensions -->

                        </div>

                        <div class="row">

                            <!-- Size Width and Height -->
                            <div class="col-12 col-sm-6" ng-repeat="(dimension, name) in {'width': 'sizeWidth', 'height': 'sizeHeight'}">
                                <div class="input-field" ng-class="{'input-invalid': optionsForm.sizeDimensionsForm[name].$invalid}">
                                    <label for="{{name}}" get-message="{{dimension}}Label"></label>
                                    <div class="input-group">
                                        <input type="number" name="{{name}}" id="{{name}}" pattern="\d+" ng-min="sizeMin(dimension)" ng-max="sizeMax(dimension)" ng-model="options.size[dimension]" ng-model-options="{ debounce: 200 }" ng-required="options.size.mode === 'custom'" />
                                        <span class="input-addon">{{sizeUnits()}}</span>
                                    </div>
                                    <p class="input-hint text-danger" ng-messages="optionsForm.sizeDimensionsForm[name].$error">
                                        <span ng-message="required">
                                            <i class="fa fa-times"></i>
                                            <i18n message="FieldRequiredMessage"></i18n>
                                        </span>
                                        <span ng-message="number">
                                            <i class="fa fa-times"></i>
                                            <i18n message="FieldPatternNumberMessage"></i18n>
                                        </span>
                                        <span ng-message="min">
                                            <i class="fa fa-times"></i>
                                            <i18n message="FieldMinValuePlaceholderMessage" substitutions="{{sizeMin(dimension)}}"></i18n>
                                        </span>
                                        <span ng-message="max">
                                            <i class="fa fa-times"></i>
                                            <i18n message="FieldMaxValuePlaceholderMessage" substitutions="{{sizeMax(dimension)}}"></i18n>
                                        </span>
                                    </p>
                                </div>
                            </div>
                            <!-- End Size Width and Height -->

                        </div>

                        <div class="row" ng-class="{'mar-t-lg': (optionsForm.sizeDimensionsForm.sizeWidth.$valid && optionsForm.sizeDimensionsForm.sizeHeight.$valid)}">

                            <div class="col">
                                <table class="table-bordered">
                                    <tbody>
                                        <tr>
                                            <td get-message="InfoCurrentScreenResolutionLabel"></td>
                                            <td class="text-bold" ng-bind-html="resolution"></td>
                                        </tr>
                                        <tr ng-show="options.size.units === 'percentage'">
                                            <td get-message="InfoPopoutPlayerWindowSizeLabel"></td>
                                            <td class="text-bold" ng-bind-html="showInfo('dimensions')"></td>
                                        </tr>
                                        <tr>
                                            <td get-message="InfoPopoutPlayerAspectRatioLabel"></td>
                                            <td class="text-bold" ng-bind-html="showInfo('aspectRatio')"></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                        </div>
                    </div>

                </div>

                <!-- Save Reminder :: Size Mode or Size Dimensions Change(s) -->
                <p class="text-small text-primary" ng-show="(optionsForm.sizeModeForm.$dirty && optionsForm.sizeModeForm.$valid) || (optionsForm.sizeDimensionsForm.$dirty && optionsForm.sizeDimensionsForm.$valid)">
                    <i class="fa fa-check-square-o"></i>
                    <i18n message="OptionsSaveSettingsReminder"></i18n>
                </p>
                <!-- End Save Reminder -->

            </fieldset>

            <fieldset>
                <legend class="text-primary">
                    <i class="fa fa-cogs mar-r-xs"></i>
                    <i18n message="OptionsAdvancedHeading"></i18n>
                </legend>

                <!-- Toggle Close Original Window/Tab -->
                <div class="input-field">
                    <span class="switch">
                        <input type="checkbox" name="advancedClose" id="advancedClose" ng-model="options.advanced.close">
                        <label for="advancedClose" get-message="OptionsAdvancedCloseLabel"></label>
                        <p class="input-hint text-primary" ng-show="optionsForm.advancedClose.$dirty && optionsForm.advancedClose.$valid">
                            <i class="fa fa-check-square-o"></i>
                            <i18n message="OptionsSaveSettingsReminder"></i18n>
                        </p>
                        <p class="input-hint" get-message="OptionsAdvancedCloseDescription"></p>
                    </span>
                </div>
                <!-- End Toggle Close Original Window/Tab -->

            </fieldset>

            <fieldset>
                <legend class="text-primary">
                    <i class="fa fa-flask mar-r-xs"></i>
                    <i18n message="OptionsExperimentalHeading"></i18n>
                </legend>

                <div class="alert alert-warning text-small" get-message="OptionsExperimentalWarningHTML"></div>

                <!-- Toggle Use New Popout Opener -->
                <div class="input-field">
                    <span class="switch">
                        <input type="checkbox" name="experimentalUseNewOpener" id="experimentalUseNewOpener" ng-model="options.experimental.useNewOpener">
                        <label for="experimentalUseNewOpener" get-message="OptionsExperimentalUseNewOpenerLabel"></label>
                        <p class="input-hint text-primary" ng-show="optionsForm.experimentalUseNewOpener.$dirty && optionsForm.experimentalUseNewOpener.$valid">
                            <i class="fa fa-check-square-o"></i>
                            <i18n message="OptionsSaveSettingsReminder"></i18n>
                        </p>
                        <p class="input-hint" get-message="OptionsExperimentalUseNewOpenerDescription"></p>
                    </span>
                </div>
                <!-- End Toggle Use New Popout Opener -->

                <hr ng-show="options.experimental.useNewOpener" />

                <!-- Open in New Window vs. Tab Radios -->
                <ng-form name="experimentalTargetForm" ng-show="options.experimental.useNewOpener">

                    <div class="input-field">
                        <label>
                            <input type="radio" name="experimentalTarget" value="window" ng-model="options.experimental.target" ng-required />
                            <i18n message="OptionsExperimentalTargetWindowLabel"></i18n>
                            <p class="input-hint" get-message="OptionsExperimentalTargetWindowDescription"></p>
                        </label>

                    </div>

                    <div class="input-field">
                        <label>
                            <input type="radio" name="experimentalTarget" value="tab" ng-model="options.experimental.target" ng-required />
                            <i18n message="OptionsExperimentalTargetTabLabel"></i18n>
                            <p class="input-hint" get-message="OptionsExperimentalTargetTabDescription"></p>
                        </label>
                    </div>

                    <p class="text-small text-primary" ng-show="optionsForm.experimentalTargetForm.$dirty && optionsForm.experimentalTargetForm.$valid">
                        <i class="fa fa-check-square-o"></i>
                        <i18n message="OptionsSaveSettingsReminder"></i18n>
                    </p>

                </ng-form>
                <!-- End Open in New Window vs. Tab Radios -->

                <hr ng-show="options.experimental.useNewOpener" />

                <!-- Title Preface -->
                <div class="input-field" ng-show="options.experimental.useNewOpener">
                    <label get-message="OptionsExperimentalTitleLabel"></label>
                    <input type="text" name="experimentalTitle" ng-model="options.experimental.title" ng-trim="false" />
                    <p class="input-hint text-primary" ng-show="optionsForm.experimentalTitle.$dirty && optionsForm.experimentalTitle.$valid">
                        <i class="fa fa-check-square-o"></i>
                        <i18n message="OptionsSaveSettingsReminder"></i18n>
                    </p>
                    <p class="input-hint" get-message="OptionsExperimentalTitleDescription"></p>
                </div>
                <!-- End Title Preface -->

            </fieldset>

            <div class="row">
                <div class="col-12" ng-show="optionsForm.$invalid">
                    <p class="text-warning">
                        <i class="fa fa-exclamation-triangle"></i>
                        <i18n message="OptionsCorrectErrorsWarning"></i18n>
                    </p>
                </div>
                <div class="col-6">
                    <button class="button button-block" ng-class="{'button-light': optionsForm.$pristine}" ng-click="save()" ng-disabled="optionsForm.$pristine || optionsForm.$invalid">
                        <i class="fa fa-check mar-r-sm"></i>
                        <i18n message="ButtonSaveLabel"></i18n>
                    </button>
                </div>
                <div class="col-6">
                    <button class="button button-block button-danger" ng-click="confirmReset()">
                        <i class="fa fa-ban mar-r-sm"></i>
                        <i18n message="ButtonResetLabel"></i18n>
                    </button>
                </div>
            </div>

            <!-- Alerts -->
            <div class="row mar-t-lg" ng-show="alerts && alerts.length">
                <div class="col">

                    <div class="fade alert alert-{{alert.type}}" ng-class="{'alert-dismissible': alert.dismissible, 'alert-timed': alert.duration}" ng-repeat="alert in alerts" style="--duration: {{alert.duration}}s">
                        <div>
                            <i class="fa fa-{{alert.icon}}" ng-show="alert.icon"></i>
                            <span ng-bind-html="alert.message"></span>
                        </div>
                        <a class="close" ng-click="removeAlert(alert)" ng-if="alert.dismissible">
                            <span class="x">&times</span>
                            <div class="timer-left"></div>
                            <div class="timer-right"></div>
                        </a>
                    </div>

                </div>
            </div>
            <!-- End Alerts -->

        </form>

        <dialog id="ResetConfirmDialog">
            <div class="container">

                <div class="row">
                    <div class="col">
                        <h3 class="mar-b-md" get-message="ConfirmSettingsResetHeading"></h3>
                        <p get-message="ConfirmSettingsResetText"></p>
                        <hr />
                    </div>
                </div>

                <div class="row">
                    <div class="col">
                        <button type="button" class="button-block" ng-click="reset()">
                            <i class="fa fa-check mar-r-sm"></i>
                            <i18n message="ButtonConfirmResetLabel"></i18n>
                        </button>
                    </div>
                    <div class="col">
                        <button type="button" class="button-block button-secondary" ng-click="cancelReset()">
                            <i class="fa fa-ban mar-r-sm"></i>
                            <i18n message="ButtonCancelResetLabel"></i18n>
                        </button>
                    </div>
                </div>

            </div>
        </dialog>

        <!-- END SETTINGS -->

        <hr />

        <!-- BEGIN COMMANDS -->

        <!-- TODO: move all of the command-related functionality into a custom directive? -->

        <form class="container-fluid">

            <fieldset ng-show="commands && commands.length">
                <legend class="text-primary">
                    <i class="fa fa-keyboard-o mar-r-xs"></i>
                    <i18n message="CommandListHeading"></i18n>
                </legend>

                <p class="text-small" get-message="CommandListSaveHelpText" ng-show="canUpdateCommands"></p>
                <p class="text-small" get-message="CommandListChangeChrome" ng-hide="canUpdateCommands"></p>

                <table>
                    <thead>
                        <tr>
                            <th get-message="CommandListDescriptionColumnHeading"></th>
                            <th get-message="CommandListShortcutColumnHeading"></th>
                            <th ng-if="canUpdateCommands"></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="command in commands" ng-if="command.description.length">
                            <td>{{command.description}}</td>
                            <td class="text-nowrap" ng-bind-html="command.shortcut | kbdCombo"></td>
                            <td ng-if="canUpdateCommands"><a href ng-click="updateCommand(command)" get-message="CommandListUpdateCommandLabel"></a></td>
                        </tr>
                    </tbody>
                </table>

            </fieldset>

        </form>

        <dialog id="UpdateCommandDialog" ng-init="initUpdateCommandDialog()">
            <div class="container">

                <div class="row">
                    <div class="col">
                        <h3 class="mar-b-md" get-message="UpdateCommandHeading"></h3>
                        <p get-message="UpdateCommandInstructionsPlaceholder" substitutions="{{getCommandInstructionSubstitutions()}}"></p>
                        <hr ng-show="updateCommandError" />
                        <div class="alert alert-danger" ng-show="updateCommandError" ng-bind-html="updateCommandError"></div>
                    </div>
                </div>

            </div>
        </dialog>

        <!-- END COMMANDS -->

    </body>

</html>
