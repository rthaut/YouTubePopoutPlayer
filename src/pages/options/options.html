<!DOCTYPE html>
<html ng-app="OptionsApp" ng-csp ng-controller="OptionsController">

    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title get-message="OptionsPageTitle"></title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css">
    </head>

    <body class="pad-y-sm pad-x-0">

        <!-- BEGIN SETTINGS -->

        <form name="optionsForm" class="container-fluid">

            <div class="alert alert-primary text-small">
                <i class="fa fa-cogs"></i>
                <i18n message="OptionsPerDeviceWarning"></i18n>
            </div>

            <fieldset>
                <legend class="text-primary" get-message="OptionsBehaviorHeading"></legend>

                <ng-form name="behaviorTargetForm">

                    <div class="input-field">
                        <label>
                            <input type="radio" name="behaviorTarget" value="window" ng-model="options.behavior.target" ng-required />
                            <i18n message="OptionsBehaviorTargetWindowLabel"></i18n>
                            <p class="input-hint" get-message="OptionsBehaviorTargetWindowDescription"></p>
                        </label>

                    </div>

                    <div class="input-field">
                        <label>
                            <input type="radio" name="behaviorTarget" value="tab" ng-model="options.behavior.target" ng-required />
                            <i18n message="OptionsBehaviorTargetTabLabel"></i18n>
                            <p class="input-hint" get-message="OptionsBehaviorTargetTabDescription"></p>
                        </label>
                    </div>

                </ng-form>

                <p class="text-small text-primary" ng-show="optionsForm.behaviorTargetForm.$dirty && optionsForm.behaviorTargetForm.$valid">
                    <i class="fa fa-check-square-o"></i>
                    <i18n message="OptionsSaveSettingsReminder"></i18n>
                </p>

                <hr />

                <div class="input-field">
                    <span class="switch">
                        <input type="checkbox" name="behaviorDisableOnPopout" id="behaviorDisableOnPopout" ng-model="options.behavior.disableOnPopout">
                        <label for="behaviorDisableOnPopout" get-message="OptionsBehaviorDisableOnPopoutLabel"></label>
                        <p class="input-hint text-primary" ng-show="optionsForm.behaviorDisableOnPopout.$dirty && optionsForm.behaviorDisableOnPopout.$valid">
                            <i class="fa fa-check-square-o"></i>
                            <i18n message="OptionsSaveSettingsReminder"></i18n>
                        </p>
                        <p class="input-hint" get-message="OptionsBehaviorDisableOnPopoutDescription"></p>
                    </span>
                </div>

                <div class="input-field">
                    <span class="switch">
                        <input type="checkbox" name="behaviorCloseOriginal" id="behaviorCloseOriginal" ng-model="options.behavior.closeOriginal">
                        <label for="behaviorCloseOriginal" get-message="OptionsBehaviorCloseOriginalLabel"></label>
                        <p class="input-hint text-primary" ng-show="optionsForm.behaviorCloseOriginal.$dirty && optionsForm.behaviorCloseOriginal.$valid">
                            <i class="fa fa-check-square-o"></i>
                            <i18n message="OptionsSaveSettingsReminder"></i18n>
                        </p>
                        <p class="input-hint" get-message="OptionsBehaviorCloseOriginalDescription"></p>
                    </span>
                </div>

            </fieldset>

            <fieldset>
                <legend class="text-primary" get-message="OptionsSizeHeading"></legend>

                <div class="alert alert-warning text-small" ng-hide="options.behavior.target === 'window'">
                    <p>
                        <i class="fa fa-warning"></i>
                        <i18n message="OptionsBehaviorTabWarning"></i18n>
                    </p>
                </div>

                <div ng-show="options.behavior.target === 'window'">

                    <ng-form name="sizeModeForm">

                        <div class="input-field">
                            <label>
                                <input type="radio" name="sizeMode" value="current" ng-model="options.size.mode" ng-required>
                                <i18n message="OptionsSizeModeCurrentLabel"></i18n>
                                <p class="input-hint" get-message="OptionsSizeModeCurrentDescription"></p>
                            </label>
                        </div>

                        <div class="input-field mar-b-0">
                            <label>
                                <input type="radio" name="sizeMode" value="custom" ng-model="options.size.mode" ng-required>
                                <i18n message="OptionsSizeModeCustomLabel"></i18n><br />
                                <p class="input-hint" get-message="OptionsSizeModeCustomDescription"></p>
                            </label>
                        </div>

                    </ng-form>

                    <div class="container-fluid mar-t-sm" ng-show="options.size.mode === 'custom'">

                        <div ng-form="sizeDimensionsForm" class="input-field mar-b-0">
                            <div class="row">

                                <div class="col">
                                    <div class="input-field">
                                        <label for="sizeModeUnits" get-message="DimensionUnitsLabel"></label>
                                        <select class="input-lg" name="sizeModeUnits" id="sizeModeUnits" ng-model="options.size.units" ng-required>
                                            <option value="pixels" get-message="DimensionUnitsPixelsOptionLabel"></option>
                                            <option value="percentage" get-message="DimensionUnitsPercentageOptionLabel"></option>
                                        </select>
                                    </div>
                                </div>

                            </div>

                            <div class="row">

                                <div class="col">
                                    <div class="input-field" ng-class="{'input-invalid': optionsForm.sizeDimensionsForm.sizeWidth.$invalid}">
                                        <label for="sizeWidth" get-message="WidthLabel"></label>
                                        <div class="input-group">
                                            <input type="number" class="input-lg" name="sizeWidth" id="sizeWidth" pattern="\d+" ng-min="sizeMin('width')" ng-max="sizeMax('width')" ng-model="options.size.width" ng-model-options="{ debounce: 200 }" ng-required="(options.behavior.target === 'window') && (options.size.mode === 'custom')" />
                                            <span class="input-addon input-addon-lg">{{sizeUnits()}}</span>
                                        </div>
                                        <p class="input-hint text-danger" ng-messages="optionsForm.sizeDimensionsForm.sizeWidth.$error">
                                            <span ng-message="required">
                                                <i class="fa fa-times"></i>
                                                <i18n message="FieldRequiredMessage"></i18n>
                                            </span>
                                            <span ng-message="number">
                                                <i class="fa fa-times"></i>
                                                <i18n message="FieldPatternNumberMessage"></i18n>
                                            </span>
                                            <span ng-message="min">
                                                <i class="fa fa-times"></i>
                                                <i18n message="FieldMinValuePlaceholderMessage" substitutions="{{sizeMin('width')}}"></i18n>
                                            </span>
                                            <span ng-message="max">
                                                <i class="fa fa-times"></i>
                                                <i18n message="FieldMaxValuePlaceholderMessage" substitutions="{{sizeMax('width')}}"></i18n>
                                            </span>
                                        </p>
                                    </div>
                                </div>

                                <div class="col">
                                    <div class="input-field" ng-class="{'input-invalid': optionsForm.sizeDimensionsForm.sizeHeight.$invalid}">
                                        <label for="sizeHeight" get-message="HeightLabel"></label>
                                        <div class="input-group">
                                            <input type="number" class="input-lg" name="sizeHeight" id="sizeHeight" pattern="\d+" ng-min="sizeMin('height')" ng-max="sizeMax('height')" ng-model="options.size.height" ng-model-options="{ debounce: 200 }" ng-required="(options.behavior.target === 'window') && (options.size.mode === 'custom')" />
                                            <span class="input-addon input-addon-lg">{{sizeUnits()}}</span>
                                        </div>
                                        <p class="input-hint text-danger" ng-messages="optionsForm.sizeDimensionsForm.sizeHeight.$error">
                                            <span ng-message="required">
                                                <i class="fa fa-times"></i>
                                                <i18n message="FieldRequiredMessage"></i18n>
                                            </span>
                                            <span ng-message="number">
                                                <i class="fa fa-times"></i>
                                                <i18n message="FieldPatternNumberMessage"></i18n>
                                            </span>
                                            <span ng-message="min">
                                                <i class="fa fa-times"></i>
                                                <i18n message="FieldMinValuePlaceholderMessage" substitutions="{{sizeMin('height')}}"></i18n>
                                            </span>
                                            <span ng-message="max">
                                                <i class="fa fa-times"></i>
                                                <i18n message="FieldMaxValuePlaceholderMessage" substitutions="{{sizeMax('height')}}"></i18n>
                                            </span>
                                        </p>
                                    </div>
                                </div>

                                <div class="col-12" ng-class="{'mar-t-lg': (optionsForm.sizeDimensionsForm.sizeWidth.$valid && optionsForm.sizeDimensionsForm.sizeHeight.$valid)}">
                                    <table class="table-bordered">
                                        <tbody>
                                            <tr>
                                                <td get-message="InfoCurrentScreenResolutionLabel"></td>
                                                <td class="text-bold" ng-bind-html="resolution"></td>
                                            </tr>
                                            <tr ng-show="options.size.units === 'percentage'">
                                                <td get-message="InfoPopoutPlayerWindowSizeLabel"></td>
                                                <td class="text-bold" ng-bind-html="showInfo('dimensions')"></td>
                                            </tr>
                                            <tr>
                                                <td get-message="InfoPopoutPlayerAspectRatioLabel"></td>
                                                <td class="text-bold" ng-bind-html="showInfo('aspectRatio')"></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>

                            </div>
                        </div>

                    </div>

                    <p class="text-small text-primary" ng-show="(optionsForm.sizeModeForm.$dirty && optionsForm.sizeModeForm.$valid) || (optionsForm.sizeDimensionsForm.$dirty && optionsForm.sizeDimensionsForm.$valid)"><i class="fa fa-check-square-o"></i>
                        <i18n message="OptionsSaveSettingsReminder"></i18n>
                    </p>

                </div>

            </fieldset>

            <fieldset ng-show="isFirefox">
                <legend class="text-primary" get-message="OptionsAdvancedHeading"></legend>

                <div class="input-field">
                    <label get-message="OptionsAdvancedTitleLabel"></label>
                    <input type="text" name="advancedTitle" ng-model="options.advanced.title" ng-trim="false" ng-disabled="options.behavior.target !== 'window'" />
                    <p class="input-hint text-warning" ng-hide="options.behavior.target === 'window'">
                        <i class="fa fa-warning"></i>
                        <i18n message="OptionsBehaviorTabWarning"></i18n>
                    </p>
                    <p class="input-hint text-primary" ng-show="optionsForm.advancedTitle.$dirty && optionsForm.advancedTitle.$valid">
                        <i class="fa fa-check-square-o"></i>
                        <i18n message="OptionsSaveSettingsReminder"></i18n>
                    </p>
                    <p class="input-hint" get-message="OptionsAdvancedTitleDescription"></p>
                </div>

            </fieldset>

            <div class="row">
                <div class="col-6">
                    <button class="button button-block" ng-class="{'button-light': optionsForm.$pristine}" ng-click="save()" ng-disabled="optionsForm.$pristine || optionsForm.$invalid">
                        <i class="fa fa-check mar-r-sm"></i>
                        <i18n message="ButtonSaveLabel"></i18n>
                    </button>
                </div>
                <div class="col-6">
                    <button class="button button-block button-danger" ng-click="confirmReset()">
                        <i class="fa fa-ban mar-r-sm"></i>
                        <i18n message="ButtonResetLabel"></i18n>
                    </button>
                </div>
            </div>

            <div class="row mar-t-lg" ng-show="alerts && alerts.length">
                <div class="col">

                    <div class="fade alert alert-{{alert.type}}" ng-class="{'alert-dismissible': alert.dismissible, 'alert-timed': alert.duration}" ng-repeat="alert in alerts" style="--duration: {{alert.duration}}s">
                        <div ng-bind-html="alert.message"></div>
                        <a class="close" ng-click="removeAlert(alert)" ng-if="alert.dismissible">
                            <span class="x">&times</span>
                            <div class="timer-left"></div>
                            <div class="timer-right"></div>
                        </a>
                    </div>

                </div>
            </div>

        </form>

        <dialog id="ResetConfirmDialog">
            <div class="container">

                <div class="row">
                    <div class="col">
                        <h3 class="mar-b-md" get-message="ConfirmSettingsResetHeading"></h3>
                        <p get-message="ConfirmSettingsResetText"></p>
                        <hr />
                    </div>
                </div>

                <div class="row">
                    <div class="col">
                        <button type="button" class="button-block" ng-click="reset()">
                            <i class="fa fa-check mar-r-sm"></i>
                            <i18n message="ButtonConfirmResetLabel"></i18n>
                        </button>
                    </div>
                    <div class="col">
                        <button type="button" class="button-block button-secondary" ng-click="cancelReset()">
                            <i class="fa fa-ban mar-r-sm"></i>
                            <i18n message="ButtonCancelResetLabel"></i18n>
                        </button>
                    </div>
                </div>

            </div>
        </dialog>

        <!-- END SETTINGS -->

        <hr />

        <!-- BEGIN COMMANDS -->

        <!-- TODO: move all of the command-related functionality into a custom directive? -->

        <form class="container-fluid">

            <fieldset ng-show="commands && commands.length">
                <legend class="text-primary">
                    <i class="fa fa-keyboard-o mar-r-xs"></i>
                    <i18n message="CommandListHeading"></i18n>
                </legend>

                <p class="text-small" get-message="CommandListSaveHelpText" ng-show="canUpdateCommands"></p>
                <p class="text-small" get-message="CommandListChangeChrome" ng-hide="canUpdateCommands"></p>

                <table>
                    <thead>
                        <tr>
                            <th get-message="CommandListDescriptionColumnHeading"></th>
                            <th get-message="CommandListShortcutColumnHeading"></th>
                            <th ng-if="canUpdateCommands"></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="command in commands" ng-if="command.description.length">
                            <td>{{command.description}}</td>
                            <td class="text-nowrap" ng-bind-html="command.shortcut | kbdCombo"></td>
                            <td ng-if="canUpdateCommands"><a href ng-click="updateCommand(command)" get-message="CommandListUpdateCommandLabel"></a></td>
                        </tr>
                    </tbody>
                </table>

            </fieldset>

        </form>

        <dialog id="UpdateCommandDialog" ng-init="initUpdateCommandDialog()">
            <div class="container">

                <div class="row">
                    <div class="col">
                        <h3 class="mar-b-md" get-message="UpdateCommandHeading"></h3>
                        <p get-message="UpdateCommandInstructionsPlaceholder" substitutions="{{getCommandInstructionSubstitutions()}}"></p>
                        <hr ng-show="updateCommandError" />
                        <div class="alert alert-danger" ng-show="updateCommandError" ng-bind-html="updateCommandError"></div>
                    </div>
                </div>

            </div>
        </dialog>

        <!-- END COMMANDS -->

    </body>

</html>
